<!doctype html>
<html>

<head>
  <title>Violin Chart</title>
  <script src="../node_modules/chart.js/dist/Chart.bundle.js"></script>
  <script src="../build/Chart.BoxPlot.js" type="text/javascript"></script>
  <script src="./utils.js"></script>
  <style>
  canvas {
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
  }
  </style>
</head>

<body>
  <div id="container" style="width: 75%;">
    <canvas id="canvas"></canvas>
  </div>
  <button id="randomizeData">Randomize Data</button>
  <button id="addDataset">Add Dataset</button>
  <button id="removeDataset">Remove Dataset</button>
  <button id="addData">Add Data</button>
  <button id="removeData">Remove Data</button>
  <script>
    const samples = this.Samples.utils;
    var color = Chart.helpers.color;
    var boxplotData = {
      labels: samples.months({count: 7}),
      datasets: [{
        label: 'Dataset 1',
        backgroundColor: color(window.chartColors.red).alpha(0.5).rgbString(),
        borderColor: window.chartColors.red,
        borderWidth: 1,
        data: [[93.6336870770901,10.6922230916098,93.2399859884754,66.878987941891,21.5706518152729,15.0841703871265,22.7674649562687,78.13892562408,17.3408215167001,33.2654693163931,93.3167831040919,61.4991157548502,69.810618693009,7.09806769154966,47.6609479170293,78.7836273666471,21.4536109706387,36.4290021359921,70.59717385564,13.9375709462911,74.7012459207326,33.127738093026,11.7927021114156,51.2412416283041,5.05112470127642,98.1458572205156,20.5896092345938,12.1511404169723,70.0372081482783,58.5390214342624,46.9196686055511,39.1729962080717,24.989673634991,92.3669849522412,12.0419515296817,8.38499164674431,26.4602856477723,22.5783228175715,75.0418779207394,64.5682760281488,39.5260067190975,57.7452776720747,78.5779551370069,95.0831783469766,24.8628431465477,2.35275225713849,19.7476897621527,42.6802739500999,96.8289195559919,92.3918998567387,35.1270471699536,9.87656898796558,54.0619349805638,44.2660674685612,37.075257091783,41.0457025747746,29.968540254049,85.1895198225975,9.86039792187512,61.2691023619846,2.74021539371461,84.3306165654212,85.014016344212,23.1830025557429,34.0102288639173,11.5938634146005,68.4241219423711,9.05940309166908,35.0573556032032,7.23134758882225,19.7400484466925,64.1462444793433,12.0594247011468,51.9686269573867,79.5877751195803,79.7597926808521,19.6089491946623,33.5583887295797,21.7081688111648,57.9510729992762,32.9591154353693,12.3070629080757,41.4670338854194,81.975905969739,24.4402950396761,75.0010005896911,7.8771953471005,87.0073315920308,61.9870463851839,88.9959783526137,50.769664440304,10.1007517194375,73.1796734035015,38.5519443778321,66.0150593379512,71.4246423449367,82.4176396476105,87.3312624404207,28.4510624594986,23.0171767063439]].concat(samples.boxplotsArray({count: 6}))
      }, {
        label: 'Dataset 2',
        backgroundColor: color(window.chartColors.blue).alpha(0.5).rgbString(),
        borderColor: window.chartColors.blue,
        borderWidth: 1,
        data: samples.boxplotsArray({count: 7})
      }]

    };

    window.onload = function() {
      var ctx = document.getElementById("canvas").getContext("2d");
      window.myBar = new Chart(ctx, {
        type: 'violin',
        data: boxplotData,
        options: {
          responsive: true,
          legend: {
            position: 'top',
          },
          title: {
            display: true,
            text: 'Chart.js Violin Chart'
          }
        }
      });

    };

    document.getElementById('randomizeData').addEventListener('click', function() {
      boxplotData.datasets.forEach(function(dataset) {
        dataset.data = samples.boxplots({count: 7});

      });
      window.myBar.update();
    });

    var colorNames = Object.keys(window.chartColors);
    document.getElementById('addDataset').addEventListener('click', function() {
      var colorName = colorNames[boxplotData.datasets.length % colorNames.length];
      var dsColor = window.chartColors[colorName];
      var newDataset = {
        label: 'Dataset ' + boxplotData.datasets.length,
        backgroundColor: color(dsColor).alpha(0.5).rgbString(),
        borderColor: dsColor,
        borderWidth: 1,
        data: samples.boxplotsArray({count: boxplotData.labels.length})
      };

      boxplotData.datasets.push(newDataset);
      window.myBar.update();
    });

    document.getElementById('addData').addEventListener('click', function() {
      if (boxplotData.datasets.length > 0) {
        var month = samples.nextMonth(boxplotData.labels.length);
        boxplotData.labels.push(month);

        for (var index = 0; index < boxplotData.datasets.length; ++index) {
          //window.myBar.addData(randomBoxPlot(), index);
          boxplotData.datasets[index].data.push(samples.numbers({count: 50}));
        }

        window.myBar.update();
      }
    });

    document.getElementById('removeDataset').addEventListener('click', function() {
      boxplotData.datasets.splice(0, 1);
      window.myBar.update();
    });

    document.getElementById('removeData').addEventListener('click', function() {
      boxplotData.labels.splice(-1, 1); // remove the label first

      boxplotData.datasets.forEach(function(dataset, datasetIndex) {
        dataset.data.pop();
      });

      window.myBar.update();
    });
  </script>
</body>

</html>
